{% style %}
{% endstyle %}
<section id="laber_{{ section.id }}">
  <div class="container">
    <div class="recently-title">
      <h2 class="inline-richtext h2 scroll-trigger animate--slide-in"><b>Recently Viewed</b></h2>
    </div>
    <div id="product-grid" class="js-recentPdpBlock product-grid row"></div>
  </div>
</section>
<script>
  // Third Block
  function getRecentPdp (){

      // First let's convert localStorage data into object again
      const pdpData = JSON.parse(localStorage.getItem('recently_viewed'));
      console.log(pdpData)
      // Create a empty Array
      const recentViewHtml = []
      // Loop through all the data and inject into HTML using ES6
      pdpData.forEach(function(item,index){ 
        if(item == 4){
           return true;
        }
          recentViewHtml.push(`
              <div id="Recent-${index}" class="grid__item product-item laber-product-item-default">
                <div class="c-product">
                    <div class="c-product__img">
                    <a href="${item.productUrl}"><img src='${item.productImg}'/></a>
                    </div>
                    <div class="product-collection__content product-grid-style style_left">
                    <div class="product-collection__title">
                      <h3 class="c-product__title">
                          <a class="c-product__url" href="${item.productUrl}">
                          ${item.productTitle}
                          </a>
                      </h3>
                    </div>
                    <p class="c-productPrice">${item.productPrice}</p>
                    <div class="frm-price-color">
                      <div class="product-collection__price ">
                        <span class="price price--sale" data-js-product-price="">
                            <span class="current">${item.productPrice}</span>
                            <span class="compare">${item.productCompPrice ? item.productCompPrice}</span>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
          `);
      })
      // Now consolidate the data 
      const recentBlock = `${recentViewHtml.join('')}`
      // console.log() to check data is correct 
      console.log(recentBlock);
      // Inject into PDP page
      const contentBlock = document.querySelectorAll('.js-recentPdpBlock');
      // Push the data
      contentBlock.forEach(element =>{
          element.innerHTML = recentBlock;
      })
     
  }
  // Execute this function on DOM content load 

  getRecentPdp();
</script>

{% schema %}
  {
    "name": "Recently viewed",
    "settings": [],
    "presets":[
      {
        "name": "Recently viewed",
        "category": "Products"
      }
    ]
  }
{% endschema %}